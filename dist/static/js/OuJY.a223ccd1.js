(window.webpackJsonp=window.webpackJsonp||[]).push([["OuJY"],{OuJY:function(e,t,l){"use strict";l.r(t);var i=l("t3Un");var a={data:function(){return{dialogVisible:!1,total:0,listQuery:{page:1,limit:10},list:[],multipleSelection:[],level_list:[],form:{id:void 0,level:void 0,name:void 0,score:void 0},level:void 0,dialogStatus:"",titleMap:{update:this.$t("table.edit"),create:this.$t("table.create")},listLoading:!0,rules:{name:[{required:!0,message:this.$t("等级名称不能为空"),trigger:"blur"}],score:[{required:!0,message:this.$t("所需积分值不能为空"),trigger:"blur"}]}}},created:function(){this.getList()},methods:{filterList:function(){this.listQuery.page=1,this.getList()},getList:function(){var e=this;this.listLoading=!0,function(e){return Object(i.a)({url:"/admin/userLevel/listPage",method:"post",data:e})}(this.listQuery).then(function(t){e.list=t.data.pageData.records,e.total=t.data.pageData.total,e.level=t.data.level,e.level_list=t.data.pageData.user_level,e.listLoading=!1})},handleSelectionChange:function(e){this.multipleSelection=e},handleCreate:function(e){this.resetForm(),this.form.level=this.level,this.dialogStatus="create",this.dialogVisible=!0},handleUpdate:function(e){var t=this;Object.keys(this.form).forEach(function(l){t.form[l]=e[l]}),this.dialogStatus="update",this.dialogVisible=!0},submitForm:function(){var e=this;this.$refs.form.validate(function(t){if(t){if(e.form.score>2147483647)return e.$message.error(e.$t("设置积分超过上限")),!1;(function(e){return Object(i.a)({url:"/admin/userLevel/saveOrUpdate",method:"post",data:e})})(e.form).then(function(t){200==t.code?(e.getList(),e.submitOk(t.message),e.dialogVisible=!1):e.submitFail(t.message)}).catch(function(e){console.log(e)})}})},handleDelete:function(e){var t=this,l="";if("all"===e)for(var a=0;a<this.multipleSelection.length;a++)l+=l?","+this.multipleSelection[a].id:this.multipleSelection[a].id;else l+=l?","+e.id:e.id;""!==l?function(e){return Object(i.a)({url:"/admin/userLevel/deleteUserLevel",method:"post",data:e})}({ids:l}).then(function(e){200==e.code?(t.filterList(),t.submitOk(e.message)):t.submitFail(e.message)}):this.$message.error(this.$t("table.delete_message"))},clearFilter:function(){this.listQuery={page:1,limit:this.listQuery.limit},this.getList()},handleDialogClose:function(){this.$refs.form&&this.$refs.form.clearValidate()},resetForm:function(){this.form={id:void 0,level:void 0,name:void 0,score:void 0}}}},s=l("KHd+"),r=Object(s.a)(a,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"app-container"},[l("cus-wraper",[l("cus-filter-wraper",[l("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:userLevel:save",expression:"'sys:userLevel:save'"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("table.add"))+"\n\t\t\t")])],1),e._v(" "),l("div",{staticClass:"table-container"},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,size:"mini",fit:"","element-loading-text":"Loading",border:"","highlight-current-row":"",align:"center"},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),l("el-table-column",{attrs:{label:e.$t("label.id"),prop:"id",align:"center",width:"100",fixed:""}}),e._v(" "),l("el-table-column",{attrs:{label:e.$t("level_name"),prop:"name",align:"center"}}),e._v(" "),l("el-table-column",{attrs:{label:e.$t("level"),prop:"level",align:"center",width:"100"}}),e._v(" "),l("el-table-column",{attrs:{label:e.$t("所需积分值"),prop:"score",align:"center",width:"150"}}),e._v(" "),this.global_checkBtnPermission(["sys:userLevel:update","sys:userLevel:del"])?l("el-table-column",{attrs:{align:"center",label:e.$t("table.actions"),width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:userLevel:update",expression:"'sys:userLevel:update'"}],attrs:{size:"mini",type:"primary",icon:"el-icon-edit",plain:""},on:{click:function(l){e.handleUpdate(t.row)}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.$t("table.edit"))+"\n\t\t\t\t\t\t")]),e._v(" "),l("cus-del-btn",{directives:[{name:"has",rawName:"v-has",value:"sys:userLevel:del",expression:"'sys:userLevel:del'"}],on:{ok:function(l){e.handleDelete(t.row)}}})]}}])}):e._e()],1),e._v(" "),l("div",{staticStyle:{padding:"10px 0",border:"1px solid #EBEEF5"}},[l("cus-del-select",{directives:[{name:"has",rawName:"v-has",value:"sys:userLevel:del",expression:"'sys:userLevel:del'"}],on:{ok:function(t){e.handleDelete("all")}}})],1),e._v(" "),l("cus-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>e.listQuery.limit,expression:"total > listQuery.limit"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){e.$set(e.listQuery,"page",t)},"update:limit":function(t){e.$set(e.listQuery,"limit",t)},pagination:e.getList}})],1),e._v(" "),l("el-dialog",{attrs:{title:e.titleMap[e.dialogStatus],visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleDialogClose}},[l("el-form",{ref:"form",staticClass:"demo-ruleForm",staticStyle:{width:"100%","max-width":"600px"},attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[l("el-form-item",{attrs:{label:e.$t("level"),prop:"level"}},[l("el-select",{model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},e._l(e.level_list,function(e){return l("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})}))],1),e._v(" "),l("el-form-item",{attrs:{label:e.$t("level_name"),prop:"name"}},[l("el-input",{attrs:{maxlength:"30"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),l("el-form-item",{attrs:{label:e.$t("所需积分值"),prop:"score"}},[l("el-input",{attrs:{maxlength:"10"},on:{input:function(t){e.form.score=e.form.score.replace(/[^\d]/g,"")}},model:{value:e.form.score,callback:function(t){e.$set(e.form,"score",t)},expression:"form.score"}})],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$t("table.cancel"))+" ")]),e._v(" "),"create"===e.dialogStatus?l("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:userLevel:save",expression:"'sys:userLevel:save'"}],attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("\n\t\t\t\t\t"+e._s(e.$t("table.confirm"))+"\n\t\t\t\t")]):e._e(),e._v(" "),"update"===e.dialogStatus?l("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:userLevel:update",expression:"'sys:userLevel:update'"}],attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("\n\t\t\t\t\t"+e._s(e.$t("table.confirm"))+"\n\t\t\t\t")]):e._e()],1)],1)],1)],1)},[],!1,null,null,null);r.options.__file="userLevel.vue";t.default=r.exports}}]);