(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7cf7"],{"1Xwi":function(e,t,r){},gAnX:function(e,t,r){"use strict";r.r(t);var n=r("xk1r"),a=r("Kw5r");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.parent,n=void 0===r?null:r,l=t.preIndex,s=void 0!==l&&l,o=t.level,c=void 0===o?0:o,d=t.expand,u=void 0!==d&&d,m=t.children,p=void 0===m?"children":m,f=t.show,h=void 0===f||f,v=t.select,b=void 0!==v&&v;e.forEach(function(e,t){var r=(s?s+"-"+t:t)+"";a.default.set(e,"_id",r),a.default.set(e,"_level",c),a.default.set(e,"_expand",u),a.default.set(e,"_parent",n),a.default.set(e,"_show",h),a.default.set(e,"_select",b),e[p]&&e[p].length>0&&i(e[p],{parent:e,level:c+1,expand:u,preIndex:r,children:p,status:status,select:b})})}var l={name:"TreeTable",props:{data:{type:Array,required:!0,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},defaultExpandAll:{type:Boolean,default:!1},defaultChildren:{type:String,default:"children"},indent:{type:Number,default:50},formIdSort:{}},data:function(){return{guard:1}},computed:{children:function(){return this.defaultChildren},tableData:function(){var e=this.data;return 0===this.data.length?[]:(i(e,{expand:this.defaultExpandAll,children:this.defaultChildren}),function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",n=[];return t.forEach(function(t,i){if(a.default.set(t,"_index",i),n.push(t),t[r]&&t[r].length>0){var l=e(t[r],r);n=n.concat(l)}}),n}(e,this.defaultChildren))}},methods:{addBrother:function(e,t){e._parent?e._parent.children.push(t):this.data.push(t)},addChild:function(e,t){e.children||this.$set(e,"children",[]),e.children.push(t)},delete:function(e){var t=e._index,r=e._parent;r?r.children.splice(t,1):this.data.splice(t,1)},getData:function(){return this.tableData},showRow:function(e){var t=e.row,r=t._parent,n=!r||r._expand&&r._show;return t._show=n,n?{animation:"treeTableShow 1s","-webkit-animation":"treeTableShow 1s"}:{display:"none"}},showSperadIcon:function(e){return e[this.children]&&e[this.children].length>0},toggleExpanded:function(e){var t=this.tableData[e],r=!t._expand;t._expand=r},handleCheckAllChange:function(e){this.selcetRecursion(e,e._select,this.defaultChildren),this.isIndeterminate=e._select},selcetRecursion:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";t&&(this.$set(e,"_expand",!0),this.$set(e,"_show",!0));var a=e[n];a&&a.length>0&&a.map(function(e){e._select=t,r.selcetRecursion(e,t,n)})},updateTreeNode:function(e){var t=this;return new Promise(function(r){var n=e._id,a=e._parent,i=n.split("-").slice(-1)[0];a?(a.children.splice(i,1,e),r(t.data)):(t.data.splice(i,1,e),r(t.data))})}}},s=(r("x7Y3"),r("KHd+")),o=Object(s.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-table",e._g(e._b({attrs:{data:e.tableData,"row-style":e.showRow}},"el-table",e.$attrs,!1),e.$listeners),[e.formIdSort?r("el-table-column",{attrs:{align:"center",label:e.$t("table.sort"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{maxlength:"5"},model:{value:e.formIdSort[t.row.id],callback:function(r){e.$set(e.formIdSort,t.row.id,r)},expression:"formIdSort[scope.row.id]"}})]}}])}):e._e(),e._v(" "),e._t("selection"),e._v(" "),e._t("pre-column"),e._v(" "),e._l(e.columns,function(t){return r("el-table-column",{key:t.key,attrs:{align:t.align||"center","header-align":t.headerAlign,label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(n){return[e._t(t.key,[t.expand?[r("span",{style:"display:inline-block;height:10px;width:"+30*n.row._level+"px;"}),e._v(" "),e.showSperadIcon(n.row)?r("span",{staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(n.$index)}}},[n.row._expand?r("i",{staticClass:"el-icon-caret-bottom",staticStyle:{color:"#606266","font-size":"18px"}}):r("i",{staticClass:"el-icon-caret-right",staticStyle:{color:"#606266","font-size":"18px"}}),e._v(" "),n.row._expand?r("svg-icon",{staticStyle:{color:"#606266","font-size":"18px"},attrs:{"icon-class":"my-folder-open"}}):r("svg-icon",{staticStyle:{color:"#606266","font-size":"18px"},attrs:{"icon-class":"my-folder-close"}})],1):r("span",[r("svg-icon",{staticStyle:{color:"#606266","font-size":"18px"},attrs:{"icon-class":"my-file"}})],1)]:e._e(),e._v(" "),t.checkbox?[n.row[e.defaultChildren]&&n.row[e.defaultChildren].length>0?r("el-checkbox",{style:{"padding-left":+n.row._level*e.indent+"px"},attrs:{indeterminate:n.row._select},on:{change:function(t){e.handleCheckAllChange(n.row)}},model:{value:n.row._select,callback:function(t){e.$set(n.row,"_select",t)},expression:"scope.row._select"}}):r("el-checkbox",{style:{"padding-left":+n.row._level*e.indent+"px"},on:{change:function(t){e.handleCheckAllChange(n.row)}},model:{value:n.row._select,callback:function(t){e.$set(n.row,"_select",t)},expression:"scope.row._select"}})]:e._e(),e._v("\n\t\t\t\t\t"+e._s(n.row[t.key])+"\n\t\t\t\t")],{scope:n})]}}])})})],2)},[],!1,null,null,null);o.options.__file="index.vue";var c=o.exports,d=r("Yfch"),u={id:"",parentId:"",url:"url",resources:"编码",title:"名称",level:"级别",sortNo:"排序",icon:"图标",type:"类型",remarks:"备注",parentName:"上级菜单"},m=[{key:"menu",display_name:"菜单"},{key:"button",display_name:"按钮"}],p={components:{treeTable:c},data:function(){return{expandAll:!1,expandAllTitle:"展开全部",tempDesc:u,listLoading:!0,columns:[{label:u.title,key:"title",width:220,expand:!0,align:"left",headerAlign:"center"},{label:u.url,key:"url"},{label:u.resources,key:"resources"},{label:u.type,key:"type"},{label:u.icon,key:"icon"},{label:u.sortNo,key:"sortNo"},{label:u.remarks,key:"remarks"}],menuList:[],menuTree:[],dialogFormVisible:!1,dialogStatus:"",titleMap:{update:this.$t("table.edit"),create:"增加"},form:{id:void 0,parentId:void 0,url:void 0,resources:void 0,title:void 0,level:void 0,sortNo:void 0,icon:void 0,type:void 0,remarks:void 0,parentName:void 0},menuTypeOptions:m,rules:{resources:[{required:!0,message:"请输入"+u.resources,trigger:"blur"},{min:1,max:100,message:"长度在 1 到 100 个字符",trigger:"blur"},{validator:function(e,t,r){t&&Object(d.c)(t)&&r(new Error("不能包含中文")),r()},trigger:"blur"}],title:[{required:!0,message:"请输入"+u.title,trigger:"blur"},{min:1,max:25,message:"长度在 1 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择"+u.type,trigger:"blur"}],sortNo:[{required:!0,message:"请输入"+u.sortNo,trigger:"blur"}],remarks:[{max:200,message:"长度最多200个字符",trigger:"blur"}]}}},created:function(){console.log("ddd"),this.global_checkBtnPermission(["sys:menu:add","sys:menu:addsub","sys:menu:edit","sys:menu:delete"])&&this.columns.push({label:this.$t("table.actions"),key:"operation",width:320}),this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,Object(n.c)().then(function(t){e.menuList=t.data.menuList,e.menuTree=t.data.menuTree,e.listLoading=!1})},handleCreate:function(e){this.resetForm(),this.dialogStatus="create",this.dialogFormVisible=!0,e||(this.form.level="1",this.form.parentId="0"),e&&(this.form.level=parseInt(e.level)+1,this.form.parentId=e.id,this.form.parentName=e.title)},handleUpdate:function(e){this.form=[],this.form.id=e.id,this.form.parentId=e.parentId,this.form.title=e.title,this.form.url=e.url,this.form.resources=e.resources,this.form.type=e.type,this.form.icon=e.icon,this.form.sortNo=e.sortNo,this.form.remarks=e.remarks,this.dialogStatus="update",this.dialogFormVisible=!0;var t=this.findTreeNode(e.parentId);t&&(this.form.parentName=t.title),this.form=Object.assign({},this.form)},handleDelete:function(e){var t=this;Object(n.a)(e.id).then(function(e){200==e.code?(t.getList(),t.submitOk(e.message)):t.submitFail(e.message)})},submitForm:function(){var e=this;this.form.parentName=void 0,this.$refs.dataForm.validate(function(t){t&&Object(n.b)(e.form).then(function(t){200==t.code?(e.getList(),e.submitOk(t.message),e.dialogFormVisible=!1):e.submitFail(t.message)})})},formatMenuType:function(e,t){switch(e.type){case"menu":return"菜单";case"button":return"按钮"}},findTreeNode:function(e){return this._.find(this.menuList,{id:parseInt(e)})},handleExpand:function(){this.expandAll=!this.expandAll,this.expandAllTitle=this.expandAll?"折叠全部":"展开全部"},resetForm:function(){this.form={id:void 0,parentId:void 0,url:void 0,resources:void 0,title:void 0,level:void 0,sortNo:void 0,icon:void 0,type:void 0,remarks:void 0,parentName:void 0}},handleDialogClose:function(){this.$refs.dataForm&&this.$refs.dataForm.clearValidate()}}},f=Object(s.a)(p,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:function(t){e.getList()}}},[e._v(e._s(e.$t("tagsView.refresh"))+"\n\t\t")]),e._v(" "),r("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:e.expandAll?"el-icon-caret-bottom":"el-icon-caret-right"},on:{click:function(t){e.handleExpand()}}},[e._v("\n\t\t\t"+e._s(e.expandAllTitle)+"\n\t\t")]),e._v(" "),r("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:menu:add",expression:"'sys:menu:add'"},{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.handleCreate()}}},[e._v("\n\t\t\t"+e._s(e.$t("table.add"))+"\n\t\t")])],1),e._v(" "),r("tree-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.menuTree,"default-expand-all":e.expandAll,columns:e.columns,border:""},scopedSlots:e._u([{key:"type",fn:function(t){var n=t.scope;return[r("span",[e._v(e._s(e.formatMenuType(n.row)))])]}},{key:"operation",fn:function(t){var n=t.scope;return[r("el-button",{directives:[{name:"show",rawName:"v-show",value:"menu"==n.row.type,expression:"scope.row.type == 'menu'"},{name:"has",rawName:"v-has",value:"sys:menu:addsub",expression:"'sys:menu:addsub'"}],attrs:{type:"primary",size:"mini",icon:"el-icon-plus",plain:""},on:{click:function(t){e.handleCreate(n.row)}}},[e._v("\n\t\t\t\t添加下级\n\t\t\t")]),e._v(" "),r("el-button",{directives:[{name:"has",rawName:"v-has",value:"sys:menu:edit",expression:"'sys:menu:edit'"}],attrs:{type:"primary",size:"mini",icon:"el-icon-edit",plain:""},on:{click:function(t){e.handleUpdate(n.row)}}},[e._v("\n\t\t\t\t"+e._s(e.$t("table.edit"))+"\n\t\t\t")]),e._v(" "),r("cus-del-btn",{directives:[{name:"has",rawName:"v-has",value:"sys:menu:delete",expression:"'sys:menu:delete'"}],on:{ok:function(t){e.handleDelete(n.row)}}})]}}])}),e._v(" "),r("el-dialog",{attrs:{title:e.titleMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.handleDialogClose}},[r("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:e.rules,model:e.form,"label-position":"right","label-width":"120px"}},[r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1!=parseInt(e.form.level),expression:"parseInt(form.level) != 1"}],attrs:{label:e.tempDesc.parentName,prop:"parentName"}},[r("el-input",{attrs:{placeholder:"请输入"+e.tempDesc.parentName,disabled:""},model:{value:e.form.parentName,callback:function(t){e.$set(e.form,"parentName",t)},expression:"form.parentName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.tempDesc.url,prop:"url"}},[r("el-input",{attrs:{placeholder:"请输入"+e.tempDesc.url},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.tempDesc.resources,prop:"resources"}},[r("el-input",{attrs:{placeholder:"请输入"+e.tempDesc.resources},model:{value:e.form.resources,callback:function(t){e.$set(e.form,"resources",t)},expression:"form.resources"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.tempDesc.title,prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入"+e.tempDesc.title},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.tempDesc.type,prop:"type"}},[r("el-select",{staticClass:"filter-item",staticStyle:{width:"280px"},attrs:{placeholder:"请选择"+e.tempDesc.type,clearable:""},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.menuTypeOptions,function(e){return r("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:e.tempDesc.icon,prop:"icon"}},[r("el-input",{attrs:{placeholder:"请输入"+e.tempDesc.icon},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.tempDesc.sortNo,prop:"sortNo"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入"+e.tempDesc.sortNo},model:{value:e.form.sortNo,callback:function(t){e.$set(e.form,"sortNo",t)},expression:"form.sortNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:e.tempDesc.remarks,prop:"remarks"}},[r("el-input",{attrs:{type:"textarea",rows:7,placeholder:"请输入"+e.tempDesc.remarks},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n\t\t\t\t"+e._s(e.$t("table.cancel"))+"\n\t\t\t")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm()}}},[e._v("\n\t\t\t\t"+e._s(e.$t("table.confirm"))+"\n\t\t\t")])],1)],1)],1)},[],!1,null,null,null);f.options.__file="menu.vue";t.default=f.exports},x7Y3:function(e,t,r){"use strict";var n=r("1Xwi");r.n(n).a},xk1r:function(e,t,r){"use strict";r.d(t,"c",function(){return a}),r.d(t,"b",function(){return i}),r.d(t,"a",function(){return l});var n=r("t3Un");function a(){return Object(n.a)({url:"/admin/menu/treeMenu",method:"post"})}function i(e){return Object(n.a)({url:"/admin/menu/save",method:"post",data:e})}function l(e){return Object(n.a)({url:"/admin/menu/delete",method:"post",data:{id:e}})}}}]);